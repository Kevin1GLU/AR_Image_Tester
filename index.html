<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <title>AR Video Demo</title>
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
    <script>
        // Register a custom event listener to start video playback when the marker is found
        AFRAME.registerComponent('registerevents', {
            init: function() {
                var marker = this.el;

                // Emit events when marker is found and lost
                marker.setAttribute('emitevents', 'true');

                marker.addEventListener('markerFound', function() {
                    // Get the video element
                    var vid = document.getElementById('webm-video');

                    // Make sure the video is visible
                    document.querySelector('#video-plane').setAttribute('visible', true);

                    // Reset video and play it from the beginning
                    vid.currentTime = 0;                    
                    vid.play();
                });
            }
        });
    </script>
</head>
<body style="margin:0; overflow:hidden;">
    <a-scene embedded arjs>
        <!-- Load assets: Image and Video -->
        <a-assets timeout="10000">
            <video id="webm-video" src="blue_shockwave.webm" loop="false" autoplay="false" preload="auto"></video>
        </a-assets>

        <!-- Marker to detect -->
        <a-marker preset="hiro" registerevents>
            <!-- Video plane that will appear when the marker is detected -->
            <a-plane id="video-plane" src="#webm-video" height="2" width="3" position="0 0 0" visible="false"></a-plane>
        </a-marker>

        <!-- Camera -->
        <a-entity camera></a-entity>
    </a-scene>
</body>
</html>
